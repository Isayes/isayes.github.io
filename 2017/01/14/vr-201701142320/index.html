<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title># 根据视角加载 / 模糊 VR 视频画面 | Notes.HF</title>
  <meta name="author" content="HuFei">
  
  <meta name="description" content="Notes of Daily Learning">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="# 根据视角加载 / 模糊 VR 视频画面"/>
  <meta property="og:site_name" content="Notes.HF"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Notes.HF" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  
</head>

<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Notes.HF</a></h1>
  <h2><a href="/">notes of buaaGS1521AA9.hufei | 用来笔记一下</a></h2>
</div>
<nav id="main-nav">
  <ul>
    
      <li><a href="/more">分类</a></li>
    
      <li><a href="/works">作品</a></li>
    
      <li><a href="http://www.cnblogs.com/isayes">博客</a></li>
    
      <li><a href="http://weibo.com/khufly">微博</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
<div class="alignleft" style="margin-top: 15px">


  <iframe src="http://ghbtns.com/github-btn.html?user=Isayes&type=follow"
  allowtransparency="true" frameborder="0" scrolling="0" width="132" height="20"></iframe>

</div>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="wrapper"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
  
    <h1 class="title"># 根据视角加载 / 模糊 VR 视频画面</h1>
  

      
        <p class="published">
          Published: <time datetime="2017-01-14T15:20:22.000Z">2017-01-14</time>
        </p>
      
    </header>
    <div class="entry">
      
        <p>关键词：VR 视频 / 模糊画面 / 全景 / 盒子 /</p>
<p>流媒体视频不变的需求是 ——『如何让视频更小、压缩得更厉害？』<br><a id="more"></a></p>
<ul>
<li><em>学习 &amp; 整理自: 知乎</em></li>
</ul>
<p>如图可知，前面的半个球是清晰的，后面的半个球是模糊的。所以这个盒子模型的六个面中，每个面可以分成两部分。一前一后。</p>
<p><img src="https://pic1.zhimg.com/7fd460808de9df884a6bef48804836c0_b.jpg" alt=""></p>
<p><a href="https://pic3.zhimg.com/c92a56fada061bbccef481b7fcd9fe42_b.jpg" target="_blank" rel="external"></a></p>
<p>有个单词叫 blurred viewport。意思是说，服务器需要找出一块你不 care 的区域，模糊掉，可以极大地节约传输的资源和渲染的资源。因为『模糊』本来就是在本地就可以处理的，也就说你拿到一块像素很低的画面，可以用模糊的手法隐去它的细节，感觉就像一个脱了眼镜的高度近视眼。下图最左边的高度模糊甚至可以隐去运动的像素。</p>
<p><img src="https://pic4.zhimg.com/5a72d564f362c3f825258177b1254467_b.jpg" alt=""></p>
<p>离线 VR 视频：</p>
<p><img src="https://pic2.zhimg.com/a89bc6134f6c2962b74b2936e41438fd_b.jpg" alt=""></p>
<p>如果把方盒子的 VR 视频做同样的优化，如图把它放在流媒体上的效果：</p>
<p><img src="https://pic2.zhimg.com/6e23010d4f4831cca423c981c035f28d_b.jpg" alt=""></p>
<p>其实若不是仔细去看，这两张图放在 VR 里差别很小，但是后者在加载的时候可以节约 30% 的加载量。</p>
<p>你站在一个盒子里，面朝的正面最清晰，而你的左面、右面、上面、下面都是靠近你正面的那一块清晰，靠近背面的那一块模糊，呈一个渐变模糊的效果，而背面，直接模糊掉。比特率的帧数也有所不同，你正面的画面要 60 帧才不卡，而你背面可能只要 30 帧、甚至 15 帧就行，当然这里的帧指的是比特率，而不是刷新率，要是刷新率低于 60，那一定晕死你~ ( 比特率是指每秒传送的比特(bit)数。单位为 bps(Bit Per Second)，比特率越高，传送数据速度越快 )</p>
<p>现在，我们把这个 VR 盒子拆开。</p>
<p><img src="https://pic3.zhimg.com/58a6f8b30925fad99dcb0b56c4c09e5e_b.jpg" alt=""></p>
<p>降低你头后面你不care的那一部分的像素。</p>
<p><img src="https://pic4.zhimg.com/c3b712d9c179f3db049fd6233ba9d587_b.jpg" alt=""></p>
<p>最后重组。这样不仅缝合得非常好，而且没有浪费一点空余的地方。</p>
<p><img src="https://pic4.zhimg.com/447fabf0fec3d6cb55e2dba4a6f46b73_b.jpg" alt=""></p>
<p>建立一个用户心理模型，用户感觉『哇，这是一个VR的空间盒子，我在里面~』</p>
<p><img src="https://pic1.zhimg.com/b85add78cd23e76072d0694dddd32adc_b.jpg" alt=""></p>
<p>但是对于流媒体引擎工程师来说，应该是下图的四棱锥 —— 你的头后面你看不到的地方模糊到只有一个像素。而你面前的 view 是最清晰的所以它有全部的像素。而上下左右四个面的像素则是朝后递减。</p>
<p>这个设计是我目前见过的最酷的设计模型了，巧妙地利用了人眼只能集中在视觉中心，而离视觉中心越远，图像越模糊，越不重要的特点。</p>
<p><img src="https://pic4.zhimg.com/9e6f2d71fdcf2b0f211245a620ffba83_b.jpg" alt=""></p>
<p>我们将一个球放入四棱锥中。</p>
<p><img src="https://pic2.zhimg.com/4bbd9f8bc914d71b929ab1a3d886f45d_b.jpg" alt=""></p>
<p>展开。</p>
<p><img src="https://pic2.zhimg.com/ad4c11126943f7920fa1165844e46c11_b.jpg" alt=""></p>
<p>直至填满四棱锥。</p>
<p><img src="https://pic3.zhimg.com/3a7f6301f08d25a68c19450959e9c332_b.jpg" alt=""></p>
<p>比如这是全景视频中的一帧。</p>
<p><img src="https://pic2.zhimg.com/9e6e3b7d646d7444ffaad20559cb03b1_b.jpg" alt=""></p>
<p>把这一帧的正面作为四棱锥的底面，折~</p>
<p><img src="https://pic4.zhimg.com/21d01e58bd28226e2ecfd61937136e5b_b.jpg" alt=""></p>
<p>合起来。</p>
<p><img src="https://pic2.zhimg.com/b7c1ece3b85b5c06aabe5912ee55eae9_b.jpg" alt=""></p>
<p>构成了一个全景四棱锥。</p>
<p><img src="https://pic4.zhimg.com/0612214d571cfa2dfd4500e23c9e7847_b.jpg" alt=""></p>
<p>这样的话能够降低文件大小的 80%，但是对于全景视频的质量也有损耗，不过因为文件较小非常适合流媒体和在线观看使用。而方形更适合下载下来看的全景视频.</p>
<p><img src="https://pic1.zhimg.com/965dc39ef948dfb77c31c225e6d385f0_b.jpg" alt=""></p>
<p>三十个不同视角的对比：</p>
<p><img src="https://pic2.zhimg.com/03548caa79fdafdaf9a539d732fae5dd_b.jpg" alt=""></p>
<p>9个不同视角的对比，不同视角间的切换。</p>
<p><img src="https://pic4.zhimg.com/14f4c74bf12cabd6ccd54c714dcdf75f_b.jpg" alt=""></p>
<p>接着我们把这个盒子展开</p>
<p><img src="https://pic3.zhimg.com/1d45c0e29b8e4622f5bfd6d3dcef79aa_b.jpg" alt=""></p>
<p><img src="https://pic4.zhimg.com/48502e6ccf04bc8869c9e75586152ec7_b.jpg" alt=""></p>
<p><img src="https://pic3.zhimg.com/66f94283bb820371d704adb134b9bd1e_b.jpg" alt=""></p>
<p><img src="https://pic4.zhimg.com/17fca820dbc55e56494a10d8c0c6f2a3_b.jpg" alt=""></p>
<p>最后它的形状还是很接近正方形。两张图一对比才发现，原来没怎么浪费空间。</p>
<p><img src="https://pic3.zhimg.com/d2451975a608a430f8101f9ccc41b446_b.jpg" alt=""></p>
<p>中间的图像很清晰，而四个角附近的图像很扭曲。</p>
<p><img src="https://pic2.zhimg.com/c93639e8807cf90f85e0f7243c6dad15_b.jpg" alt=""></p>
<p>四棱锥是最自然的模糊方式，请想象把4K大小的画面叠起来，然后折成四棱锥。</p>
<p><img src="https://pic1.zhimg.com/2a7bfd5cfa92324d8c9b7b9e594c1018_b.jpg" alt=""></p>
<p>注意这张图是泪珠体而不是圆锥体哦~</p>
<p><img src="https://pic4.zhimg.com/0482db83c982de7aac70ad4dfe709c5f_b.jpg" alt=""></p>
<p>如果要做模糊，经常需要思考在什么地方模糊？模糊程度是多少？横坐标是角度，比如你正对的那个方向就是 0°，而你的正后方则是 180°。所以从 0 到 180 度，越来越模糊，而且是呈线性模糊。0° 是你正朝着的那个方向，而它的中点是你最关注的那个点，所以最清晰，细节最多；而 180° 是你最不关注的那个点，所以最模糊，细节最少。</p>
<p><img src="https://pic4.zhimg.com/01752f8467bef43ebbac7d7492df0d8b_b.jpg" alt=""></p>
<p>但是它如果用户突然转过头来，发现这里有点模糊，而服务器那边还要急忙赶着加载呢~所以这也是目前的弊端。目前的做法是设置一个blood parameters，越过这个点，图像开始变得模糊。</p>
<p><img src="https://pic3.zhimg.com/4b0c8f5205b141504ee55ba57aceaebe_b.jpg" alt="空间采样（spatial subsamping）"></p>
<p>横坐标是 viewport 的大小，清晰的范围有多大？纵坐标则是模糊的强度。绿线白点减少 20%，蓝线红点减少 30%，紫线蓝点减少40%，可以发现，后面的就直接和Y轴垂直了。这张图说明了，即使你把模糊程度调到最高，也不一定能够把比特率降得很低。</p>
<p><img src="https://pic1.zhimg.com/6a7e8bad80cc6dd76b6c8fd60f1e88e4_b.jpg" alt=""></p>
<p>所以，我们只需要找到这个临界值即可。所以我们如果把后方的部分模糊掉，就可以节约出30%的像素。</p>
<p><img src="https://pic4.zhimg.com/cba8a7b09ef73510b501cb0f8f3bdab3_b.jpg" alt=""></p>
<ul>
<li><em>原文: <a href="https://www.zhihu.com/question/40452784" target="_blank" rel="external">https://www.zhihu.com/question/40452784</a></em></li>
</ul>
<p>Note by <a href="http://isayes.github.io" target="_blank" rel="external">HF</a>.  </p>
<hr>

      
    </div>
    <footer>
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>
<!-- hackish -->

  
</div>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 HuFei
  
</div>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="http://apps.bdimg.com/libs/fancybox/2.1.5/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>