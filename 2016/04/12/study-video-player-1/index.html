<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title># 对视频播放器的研究 &amp;1 | Notes.HF</title>
  <meta name="author" content="HuFei">
  
  <meta name="description" content="Notes of Daily Learning">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="# 对视频播放器的研究 &amp;1"/>
  <meta property="og:site_name" content="Notes.HF"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Notes.HF" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  
</head>

<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Notes.HF</a></h1>
  <h2><a href="/">notes of buaaGS1521AA9.hufei | 用来笔记一下</a></h2>
</div>
<nav id="main-nav">
  <ul>
    
      <li><a href="/more">分类</a></li>
    
      <li><a href="/works">作品</a></li>
    
      <li><a href="http://www.cnblogs.com/isayes">博客</a></li>
    
      <li><a href="http://weibo.com/khufly">微博</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
<div class="alignleft" style="margin-top: 15px">


  <iframe src="http://ghbtns.com/github-btn.html?user=Isayes&type=follow"
  allowtransparency="true" frameborder="0" scrolling="0" width="132" height="20"></iframe>

</div>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="wrapper"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
  
    <h1 class="title"># 对视频播放器的研究 &amp;1</h1>
  

      
        <p class="published">
          Published: <time datetime="2016-04-12T12:38:38.000Z">2016-04-12</time>
        </p>
      
    </header>
    <div class="entry">
      
        <p>关键词：ijkplayer / 播放器 / 视频技术</p>
<p>本次笔记主要梳理了几家主流视频播放器的调研和对视频技术的初步分析。<a id="more"></a></p>
<h2 id="1-对几家视频播放器的调研对比"><a href="#1-对几家视频播放器的调研对比" class="headerlink" title="1. 对几家视频播放器的调研对比 #"></a>1. 对几家视频播放器的调研对比 #</h2><p>（1）ijkplayer    </p>
<ul>
<li>支持 Android 和 iOS 平台；</li>
<li>API 易于集成；</li>
<li>编译配置可裁剪，方便控制安装包大小；</li>
<li>支持硬件加速解码；</li>
<li>移除了 ffmpeg 视频内核中不常用的特性以减小体积；</li>
<li>使用各种平台原生的渲染方式进行优化，修复一些在线视频播放的 BUG；</li>
<li>开源；</li>
</ul>
<p>（2）Vitamio</p>
<ul>
<li>支持 Android 和 iOS 平台；</li>
<li>支持硬件解码与 GPU 渲染，API 接口简洁易用；</li>
<li>目前，全球已经有超过一万种应用在使用 vitamio，覆盖用户超过 5 亿；</li>
<li>可播放 720P 甚至 1080P 高清 MKV / FLV / MP4 / MOV / TS / RMVB等常见格式的视频</li>
<li>支持 MMS / RTSP / RTSP / HLS(m3u8) 等常见协议，包括点播与直播；</li>
<li>高级功能收费；</li>
</ul>
<p>（3）VLC</p>
<ul>
<li>全名是 Video Lan Client，是一个开源的、跨平台的视频播放器，支持大量的音视频传输、封装和编码格式</li>
<li>几乎支持所有的视频格式，也很注重版权方面的问题，程序结构的扩展性好；</li>
<li>开源；</li>
<li>项目庞大；</li>
</ul>
<p>（4）优酷</p>
<ul>
<li>优酷公司开放的播放器框架，支持 Android / iOS / Web 平台，用于播放优酷视频网站的视频；</li>
<li>呵呵，比较封闭；</li>
<li>接口不够丰富，不支持 1080P；</li>
<li>不开源；</li>
</ul>
<p>对我个人而言，更喜欢 ijkplayer，有以下几个原因：<br></p>
<ol>
<li>它开源，便于掌握关键机制和定制功能；<br></li>
<li>项目代码比较精简，相对于 VLC 来说，研究难度小一些；<br></li>
<li>功能强大，主流视频格式和协议都支持；<br></li>
</ol>
<h2 id="2-视频技术的初步分析"><a href="#2-视频技术的初步分析" class="headerlink" title="2. 视频技术的初步分析 #"></a>2. 视频技术的初步分析 #</h2><p><img src="http://ww1.sinaimg.cn/large/a53846c3gw1f3xjo1vml5j20so076mzq.jpg" alt=""></p>
<ol>
<li>接入模块基于网络协议从视频流中提取真正的视频数据，并存放到下载缓冲区中；  </li>
<li>解复用模块将音频和视频内容分离开；</li>
<li>解码模块分别对音频和视频内容进行解码，把压缩的数据还原成原始音视频数据，类似一张张位图格式的图像，并存入解码缓冲区；</li>
<li>输出模块，从解码缓冲区读取数据并完成渲染实现视频的播放；</li>
<li>控制器模块，通过与其它模块的交互，完成同步音视频流，进行控制播放速度以及暂停快进等操作，获取视频流的媒体信息，调整视频亮度等功能；</li>
</ol>
<h2 id="3-关于-ijkplayer"><a href="#3-关于-ijkplayer" class="headerlink" title="3. 关于 ijkplayer #"></a>3. 关于 ijkplayer #</h2><p><img src="http://ww2.sinaimg.cn/mw690/a53846c3gw1f3xkjqm7gzj20ly09iwhj.jpg" alt=""></p>
<ol>
<li>准备软硬件。准备 PC 机，JDK，Android SDK，Android NDK，git，yasm 编译器环境；</li>
<li>下载项目代码。git clone ijkplayer 源代码和 ffmpeg 源代码；</li>
<li>编译播放器内核。编译 ffmpeg 生成库（libijkffmpeg.so 用于解码，libijksdl.so 用于播放和显示，其它平台库用于 ijkplayer 编译）；</li>
<li>编译播放器工程。编译 ijkplayer 生成库（libijkplayer.so 支持播放器主要的功能实现）；</li>
<li>基于 Android 开发环境，导入 3 和 4 中的库文件，并基于 ijkplayer 源码中的内容，构建项目工程完成播放器应用的开发；</li>
</ol>
<p>ffmpeg 编译之后主要是用于生成 libijksdl.so，ibijkffmpeg.so<br>两个分别主宰不同的方向：libijksdl.so 用于绘图显示（视频播放线程等和键鼠操控）；libijkffmpeg.so用于数据解码等处理；</p>
<p>整体解码内核使用了 3 个第三方库：</p>
<ol>
<li>ffmpeg 生成 libijkffmpeg.so</li>
<li>sdl 生成 libijksdl.so</li>
<li>libyuv 被静态链接进 sdl 中</li>
</ol>
<p>作者的播放器库：<br>libijkplayer.so<br>基于 ffplay，增加了不少东西，是 player 级别的关键代码<br>作者自主功能主要在 libijkplayer.so 这块</p>
<h2 id="4-播放器技术能力了解的重点"><a href="#4-播放器技术能力了解的重点" class="headerlink" title="4. 播放器技术能力了解的重点 #"></a>4. 播放器技术能力了解的重点 #</h2><ol>
<li>如何定制化视频框架；</li>
<li>实时码率是否可以获取；</li>
<li>视频分片的统计信息（分片下载时延，分片大小等）是否可以获取；</li>
<li>播放器缓冲区模型和机制是否了解，是否可以限定初始缓冲量的大小（缓冲区作为重点调研下，如“播放器到底有几个缓冲区，怎么分，完全开源的应该怎么设置，解码缓冲区用来设置已经解码的还是待解码的”等问题）；</li>
<li>是否可以直接在播放内部通过缓存区填充情况计算流量和速率；</li>
<li>是否支持 HTTP + Range 的播放方式（当前多数主流视频网站已更新为当前这种机制）；</li>
<li>VR 产品和应用发展迅速，后续在现场会议，演唱会，游戏等行业会大行其道，对于 VR 视频的播放，如何解决同传统视频播放有什么差别；</li>
</ol>
<h2 id="5-其它"><a href="#5-其它" class="headerlink" title="5. 其它  #"></a>5. 其它  #</h2><p><a href="http://dranger.com/ffmpeg/" target="_blank" rel="external">http://dranger.com/ffmpeg/</a><br>这应该是目前网络上大多数教程的参考源。</p>
<p><a href="http://blog.csdn.net/leixiaohua1020/article/details/15811977" target="_blank" rel="external">http://blog.csdn.net/leixiaohua1020/article/details/15811977</a><br>这是一个总结性的文章，作者对 FFmpeg 的底层做了很多的研究，Android 端太少，但是源码分析的很不错，唯一可惜的是作者没有敢去分析 ffplay 的源码，要不我们的工作量或者我们对播放的原理理解就会进入一个新的高度</p>
<p><a href="http://dande618.github.io/blog/2013/10/29/FFMepg/" target="_blank" rel="external">http://dande618.github.io/blog/2013/10/29/FFMepg/</a><br>这个博客的代码对音频进行了较好的处理（虽然不大懂，但确实可以工作）</p>
<p><a href="http://www.cnblogs.com/tanlon/p/3966130.html" target="_blank" rel="external">http://www.cnblogs.com/tanlon/p/3966130.html</a><br>这个博客的作者对很多音视频相关的内容进行了多个平台的实践，值得参考</p>
<p><a href="https://github.com/dxjia/ffmpeg-jni-sample" target="_blank" rel="external">https://github.com/dxjia/ffmpeg-jni-sample</a><br>这位作者使用 FFmpeg 将本地视频转成 gif 图片播放，源码由于环境的缘故还没有测试，但好歹是一个突破。</p>
<p><a href="http://blog.csdn.net/jwzhangjie/article/details/9111547" target="_blank" rel="external">http://blog.csdn.net/jwzhangjie/article/details/9111547</a><br>本地视频播放器开发–SDL 编译编译中编译出 sdl 的支持库，只可惜是本地的</p>
<p>End.</p>
<p>Note by <a href="http://isayes.github.io" target="_blank" rel="external">HF</a>.  </p>

      
    </div>
    <footer>
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>
<!-- hackish -->

  
</div>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 HuFei
  
</div>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="http://apps.bdimg.com/libs/fancybox/2.1.5/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>